---
title: "seqFISH Mouse Visual Cortex"
author: "Dario Righelli"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
    BiocStyle::html_document:
      toc_float: true
vignette: >
    %\VignetteIndexEntry{seqFISH Mouse Visual Cortex}
    %\VignetteEncoding{UTF-8}
    %\VignetteEngine{knitr::rmarkdown}
Package: SingleCellMultiModal
bibliography: ../inst/REFERENCES.bib
editor_options: 
  chunk_output_type: console
---

# Installation

```{r,eval=FALSE}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("SingleCellMultiModal", version="devel")

library(devtools)
install_github("drighelli/SpatialExperiment", ref="spatialExperiment")
```

## Load

```{r,include=TRUE,results="hide",message=FALSE,warning=FALSE}
library(SingleCellMultiModal)
library(MultiAssayExperiment)
library(SpatialExperiment)
```


# seq-FISH data

The dataset consists of two data types,
seq-FISH data was provided by @Zhu2018identification, while scRNA-seq data
was provided by @Tasic2016adult.

Data have been retrievedas part of the 
[Hackathon](https://github.com/BIRSBiointegration/Hackathon/tree/master/seqFISH)
in the 
[Mathematical Frameworks for Integrative Analysis of Emerging Biological DataTypes](https://www.birs.ca/events/2020/5-day-workshops/20w5197) workshop.

## Downloading datasets

The user can see the available dataset by using the default options

```{r}
SingleCellMultiModal::seqFISH(dataType="mouse_visual_cortex", 
                                        modes="*", dry.run=TRUE)
```

Or by simply running:


```{r}
mse <- SingleCellMultiModal::seqFISH(dataType="mouse_visual_cortex", 
                                      modes="*", dry.run=FALSE)
```

Example with actual data:

```{r}
experiments(mse)
```


## Exploring the data structure

Check row annotations:

```{r}
rownames(mse)
```

Take a peek at the `sampleMap`:

```{r}
sampleMap(mse)
```


## scRNA-seq data

The scRNA-seq data are accessible with `$scRNAseq`, which returns a 
*SingleCellExperiment* class object, with all its associated methods.

```{r}
experiments(mse)$scRNAseq
```

Otherwhise the `assay` function can be used to access the *scRNAseq* assay
stored in the `mse` *MultiAssayExperiment* object.

```{r}
head(assay(mse, "scRNAseq"))[,1:4]
```

## seq-FISH data

The seq-FISH data are accessible with `$seqFISH`, which returns a 
**SpatialExperiment** class object.

```{r}
experiments(mse)$seqFISH
```

Otherwhise the `assay` function can be used to access the *seqFISH* assay
stored in the `mse` *MultiAssayExperiment* object.

```{r}
head(assay(mse, "seqFISH"))[,1:4]
```

Spatial coordinates can be retrieved with `spatialCoords` function on the 
*SpatialExperiment* object.

```{r}
(sc <- spatialCoords(experiments(mse)$seqFISH))
```

They can also be stored by using the `<-` operator.

```{r}
fakeCoords <- cbind(sc[,c(1:3)], sc[,3])
colnames(fakeCoords)[4] <- "y"
spatialCoords(experiments(mse)$seqFISH) <- fakeCoords
spatialCoords(experiments(mse)$seqFISH)
```

# Session Info

```{r}
sessionInfo()
```

